\documentclass[11pt]{article}

\usepackage{ctex}
\setsansfont{Noto Sans CJK SC Light}
\setCJKsansfont[ItalicFont=Kaiti SC]{Noto Sans CJK SC Light}
\setCJKmainfont{Noto Serif CJK SC Light}
\usepackage{graphicx}
\graphicspath{ {./images/} }
\usepackage{amsmath}
\usepackage{multicol}
\usepackage{enumitem}
\usepackage{lastpage}
\usepackage{fancyhdr}
\renewcommand{\headrulewidth}{0pt}
\fancyhead{}
\cfoot{第{\thepage}页，共\pageref{LastPage}页}
\pagestyle{fancy}
\usepackage{geometry}
 \geometry{
 a4paper,
 total={170mm,257mm},
 left=40mm,
 top=20mm,
 right=20mm,
 }
\usepackage{titlesec}
\renewcommand\thesection{\chinese{section}}
\titleformat{\section}
  {\normalfont\large\bfseries}{\thesection.}{1em}{}
  
\DeclareEmphSequence{\bfseries,\itshape,\upshape}

\newif\ifsolution

%%% 是否显示答案
%\solutiontrue
%\solutionfalse

\newcounter{question}
\newenvironment{choice}[2][X]
    {\refstepcounter{question}
        \textbf{\thequestion.} #2
        \hfill\mbox{[\ifsolution{#1}\else\quad\fi]}
        \begin{multicols}{2}
        \begin{enumerate}[label=(\Alph*)]
    }
    {
        \end{enumerate}
        \end{multicols}
    }
\newenvironment{question}[1][XXX]
    {\refstepcounter{question}
        \textbf{\thequestion.}\def\thesolution{#1}
    }
    {}
\usepackage{comment}
\ifsolution
    \newenvironment{solution}[1][10cm]{答案：}{}
\else
    \usepackage{environ}
    \NewEnviron{hide}{}
    \newenvironment{solution}[1][10cm]{答案：\vspace{#1}\hide}
    {\endhide}
\fi


\makeatletter
\renewcommand\maketitle{
\begin{center}
{\LARGE \bfseries \@title}\\[2ex]
\end{center}
}
\makeatother

\title{西南交通大学2021--2022学年第(II)学期考试试卷B}

\usepackage{eso-pic}
\usepackage{dashrule}
\newcommand\BackgroundPicture{
   \put(0,0){\rotatebox{90}{
     \parbox[b][3.5cm]{\paperheight}{
        \vspace{1cm}
        \hfil \textbf{班级}：\underline{\hspace{5cm}}%
        \hfil \textbf{学号}：\underline{\hspace{5cm}}%
        \hfil \textbf{姓名}：\underline{\hspace{5cm}}\hfil
        \vfill
        {\tiny \hfil 密封装订线\hfil 密封装订线\hfil 密封装订线}
        
        \hdashrule[0.5ex][c]{\linewidth}{0.6pt}{1.5mm}
    }}}}
\AddToShipoutPicture*{\BackgroundPicture}

\usepackage{bm}
\newcommand{\mat}[1]{\bm{#1}}
\renewcommand{\vec}[1]{\bm{#1}}
\DeclareMathOperator*{\argmin}{arg\,min}

\newcommand{\MA}{\mat{A}}
\newcommand{\MI}{\mat{I}}
\newcommand{\Va}{\Vec{a}}
\newcommand{\Vy}{\vec{y}}
\newcommand{\Vx}{\vec{x}}
\newcommand{\Ve}{\vec{e}}
\newcommand{\Vw}{\vec{w}}
\newcommand{\Vt}{\vec{\theta}}
\newcommand{\SR}{\mathcal{R}}
\newcommand{\DN}{\mathcal{N}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\maketitle
课程代码：\underline{TRAL008012}%
\hfill 课程名称：\underline{交通数据分析}%
\hfill 考试时间：\underline{120分钟}

\begin{center}
\begin{tabular}{|p{0.6cm}|p{0.6cm}|p{0.6cm}|p{0.6cm}|p{0.6cm}|p{0.6cm}|p{0.6cm}|p{0.6cm}|p{0.6cm}|p{0.6cm}|}
    \hline
    1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10\\
    \hline
    & & & & & & & & &  \\
    \hline
    11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20\\
    \hline
    & & & & & & & & &  \\
    \hline
    21 & 22 & 23 & 24 & 25 & 26 & 27 & 28 & 29 & 30\\
    \hline
    & & & & & & & & &  \\
    \hline
\end{tabular}
\end{center}
\vspace{2ex}
\hfil 阅卷教师签字：\underline{\hspace{8cm}} \hfil

\section{选择题\textmd{(20小题，每小题3分，共60分)}}

\begin{choice}[B]{交通领域可使用多种形式的原始数据，以下检测方式中利用电磁感应感知车辆的是
    哪一个}
    \item 感应线圈检测器
    \item 车辆GPS轨迹数据
    \item 交叉口车牌识别数据
    \item OD调查数据
\end{choice}

\begin{choice}[C]{综合考虑成本和效率，\emph{最适合}采集出行者社会经济情况数据的手段是}
    \item 出租车GPS定位
    \item 交叉口车牌识别
    \item 手机基站定位
    \item 问卷调查
\end{choice}

\begin{choice}[A]{根据分类\emph{示例}将数据划分为多个类别的模型称为}
    \item 回归模型
    \item 分类模型
    \item 聚类模型
    \item 滤波模型
\end{choice}

\begin{choice}[A]{对于\emph{线性回归}模型$y=w\cdot x+b$，损失函数$L$的定义是}
    \item $L=\sum |y-w\cdot x-b|$
    \item $L=\sum (y-w\cdot x-b)$
    \item $L=\sum (y-w\cdot x-b)^2$
    \item $L=\sum (y-w\cdot x-b)^3$
\end{choice}

\begin{choice}[D]{机器学习模型参数\emph{欠拟合}现象是指模型损失函数}
    \item 在训练集上大，在测试集上小
    \item 在训练集上大，在测试集上大
    \item 在训练集上小，在测试集上小
    \item 在训练集上小，在测试集上大
\end{choice}

\begin{choice}[C]{当模型与数据出现\emph{欠拟合}时，可能的解决方法是}
    \item 减少参数数量
    \item 增加参数数量
    \item 缩小参数取值范围
    \item 扩大参数取值范围
\end{choice}

\begin{choice}[A]{某数据集包含10000个数据点，前后5000点分别来自A、B两个场景。分析A场景时选择数据的正确方式是}
    \item 随机抽取5000个数据点
    \item 顺序抽取前5000个数据点
    \item 顺序抽取后5000个数据点
    \item 抽取自变量取值最小的5000个数据点
\end{choice}

\begin{choice}[A]{Logistic回归中用到的映射函数是}
    \item $\sigma(x)=\frac{e^x}{1+e^x}$
    \item $\sigma(x)=\frac{1}{1+e^x}$
    \item $\sigma(x)=\frac{e^x+1}{e^x}$
    \item $\sigma(x)=\frac{e^x+1}{1}$
\end{choice}

\begin{choice}[D]{线性回归的损失函数称为}
    \item 均方差函数
    \item 0-1损失函数
    \item 铰链损失函数
    \item 交叉熵损失函数
\end{choice}

\begin{choice}[B]{支持向量机模型中\emph{支持向量}是指}
    \item 满足$y_i(w\cdot x_i+b)> 1$的数据点
    \item 满足$y_i(w\cdot x_i+b)= 1$的数据点
    \item 满足$y_i(w\cdot x_i+b)= 0$的数据点
    \item 满足$y_i(w\cdot x_i+b)> 0$的数据点
\end{choice}

\begin{choice}[D]{以下聚类方法中直接利用了高斯分布函数性质的方法是}
    \item K-平均聚类
    \item K-Medoids聚类
    \item 高斯混合聚类
    \item DBSCAN聚类
\end{choice}

\begin{choice}[A]{高斯混合模型公式如下
    \[f_M(x)=\sum_{i=1}^k\alpha_i\cdot
    \frac{1}{2\pi\sqrt{|\Sigma|}}e^{-\frac{1}{2}
    (y-\mu)^T\Sigma^{-1}(y-\mu)}\]
    其中协方差矩阵是
    }
    \item $\alpha_i$
    \item $\Sigma$
    \item $y$
    \item $\mu$
\end{choice}

\begin{choice}[B]{神经网络的\emph{规模}是指}
    \item 神经元总数
    \item 层数
    \item 输入属性数量
    \item 输出属性数量
\end{choice}

\begin{choice}[D]{单层神经网络的局限性表现在\emph{不能拟合}}
    \item 与门AND
    \item 或门OR
    \item 非门NOT
    \item 异或门XOR
\end{choice}

\begin{choice}[B]{当前时间序列数据处理中最常用的神经网络形式是}
    \item 分层神经网络
    \item 卷积神经网络
    \item 循环神经网络
    \item LSTM
\end{choice}

\begin{choice}[A]{神经网络常用激活函数形式中\emph{最早}被广泛采用的是}
    \item ReLU
    \item Sigmoid
    \item Tanh
    \item Softmax
\end{choice}

\begin{choice}[C]{应用贝叶斯公式中经常被省略掉的部分是}
    \item 先验概率
    \item 后验概率
    \item 似然概率
    \item 数据全概率
\end{choice}

\begin{choice}[B]{Kalman滤波模型中描述系统状态值$x$随时间自发变化的矩阵是}
    \item 系统状态转移矩阵
    \item 观测矩阵
    \item 协方差矩阵
    \item 正交矩阵
\end{choice}

\begin{choice}[A]{以下滤波模型中对噪音为正态分布的数据效果最好的是}
    \item 贝叶斯滤波
    \item G-H滤波
    \item Kalman滤波
    \item 粒子滤波
\end{choice}

\begin{choice}[D]{用于可视化绘图的Python模块是}
    \item matplotlib
    \item pandas
    \item scikit
    \item numpy
\end{choice}

\newpage
\section{简答题\textmd{(2小题，每题8分，共16分)}}

\begin{question}
    什么是最小二乘法公式，举例说明其应用
\end{question}

\begin{question}
    什么是支持向量机，举例说明其应用。
\end{question}

\newpage
\section{计算题\textmd{(2小题，每题12分，共24分)}}
\begin{question}
    给定8个数据点，用线性回归估计变量$x$，$y$之间的关系。随机选取
    $\{1,3,4,7\}$号数据为训练集，$\{2,5,6,8\}$号数据为测试集。
    \begin{enumerate}[label=(\alph*)]
        \item 用二阶模型$y=w_2x^2+w_1x+b$拟合训练集
        \item 计算模型在训练集和测试集上的\emph{均方差}
        \item 比较两个结果，判断是否存在过拟合现象
    \end{enumerate}
\begin{center}
\begin{tabular}{p{2cm} p{0.6cm} p{0.6cm} p{0.6cm} p{0.6cm} p{0.6cm} p{0.6cm} p{0.6cm} p{0.6cm}}
    \hline
    编号 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8\\
    \hline
    \hline
    $x$ & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8\\
    $y$ & 1 & 4 & 3 & 7 & 5 & 3 & 7 & 8\\
    \hline
\end{tabular}
\end{center}
\end{question}

\begin{solution}
    \begin{enumerate}[label=(\alph*)]
        \item \emph{用一阶模型$y=wx+b$拟合训练集}
        
        假设直线$y=wx+b$通过${1,3,4}$点，列出线性方程组
        \begin{equation}\label{ls}
            \MA\cdot\Vt=\Vy
        \end{equation}
        其中
        \begin{equation}\label{value1}
            \MA=\left[\begin{array}{rr}
                1 & 1 \\
                1 & 3 \\
                1 & 4
                \end{array}\right],\, 
            \Vt=\begin{bmatrix}
                w\\
                b
            \end{bmatrix},\,
            \Vy = \begin{bmatrix}
                1\\
                3\\
                7
            \end{bmatrix}
        \end{equation}
        该方程组无解，使用最小二乘法得到近似问题
        \begin{equation}
            \label{lsq}
            \MA^T\cdot\MA\Vt=\MA^T\cdot\Vy
        \end{equation}
        将式\ref{value1}代入式\ref{lsq}，整理后得到
        \begin{equation*}
            \left[\begin{array}{rr}
                3 & 8 \\
                8 & 26
                \end{array}\right]
                \cdot
                \begin{bmatrix}
                    w\\
                    b
                \end{bmatrix}
                =\begin{bmatrix}
                    11\\
                    38
                \end{bmatrix}
        \end{equation*}
        求解得到
        \begin{equation}
            \begin{bmatrix}
                w\\
                b
            \end{bmatrix}
            =\begin{bmatrix}
                -\frac{9}{7}\\
                \frac{13}{7}
            \end{bmatrix}
            \approx
            \begin{bmatrix}
                -1.29\\
                1.86
            \end{bmatrix}
        \end{equation}
        \item \emph{用二阶模型$y=w_2x^2+w_1x+b$拟合训练集}
        
        对于二阶模型有
        \begin{equation}
            \label{value2}
            \MA=\left[\begin{array}{rrr}
                1 & 1 & 1 \\
                9 & 3 & 1 \\
                16 & 4 & 1
                \end{array}\right],\,
            \Vt=
            \begin{bmatrix}
            w_2\\
            w_1\\
            b
            \end{bmatrix},\,
            \Vy = \begin{bmatrix}
                1\\
                3\\
                7
            \end{bmatrix}
        \end{equation}
        将式\ref{value2}代入式\ref{ls}，直接求解有
        \begin{equation}
            \begin{bmatrix}
            w_2\\
            w_1\\
            b
            \end{bmatrix}=
            \begin{bmatrix}
                1\\
                -3\\
                3
            \end{bmatrix}
        \end{equation}
        \item \emph{计算一、二阶模型在测试集上的\emph{均方差}}
        
        均方差公式为
        \begin{equation}\label{rms}
            \textrm{MSE}=\frac{\sum\limits_{i=1}^{n}(y_i-\hat{y}_i)^2}{n}=
            \frac{(\Vy-\hat{\Vy})^T\cdot(\Vy-\hat{\Vy})}{n}
        \end{equation}
        在测试集合上，输入值
        \begin{equation}
            \Vx=\left[2,\,5,\,6,\,7,\,8\right]^T
        \end{equation}
        对应的参考值
        \begin{equation}
            \Vy=\left[4,\,5,\,3,\,7,\,8\right]^T
        \end{equation}
        一阶模型的预测值为
        \begin{equation}
            \begin{split}
            \hat{\Vy}^{(1)}&=w\Vx+b\\
            &=-\frac{9}{7}\cdot\left[2,\,5,\,6,\,7,\,8\right]^T+\frac{13}{7}\\
            &\approx \left[-0.72,\,-4.6,\,-5.9,\,-7.2,\,-8.5\right]^T
            \end{split}
        \end{equation}
        代入公式\ref{rms}有
        \begin{equation}
            \begin{split}
            \textrm{MSE}^{(1)}&=\frac{(\Vy-\hat{\Vy}^{(1)})^T\cdot(\Vy-\hat{\Vy}^{(1)})}{n}\\
            &\approx132.96
            \end{split}
        \end{equation}

        二阶模型预测值为
        \begin{equation}
            \begin{split}
            \hat{\Vy}^{(2)}&=w_2\Vx^2+w_1\Vx+b\\
            &=\left[1,\,13,\,21,\,31,\,43\right]^T
            \end{split}
        \end{equation}
        代入公式\ref{rms}有
        \begin{equation}
            \begin{split}
            \textrm{MSE}^{(2)}&=\frac{(\Vy-\hat{\Vy}^{(2)})^T\cdot(\Vy-\hat{\Vy}^{(2)})}{n}\\
            &= 439.6
            \end{split}
        \end{equation}
        \item \emph{评价两个模型}
        \begin{itemize}
            \item 在训练集上二阶模型完美拟合，均方差为0，小于一阶模型
            \item 在测试集上二阶模型的均方差反而大于一阶模型
            \item 二阶模型缺乏迁移性，可能存在过拟合问题
        \end{itemize}
    \end{enumerate}
\end{solution}
\newpage

\begin{question}
    给定8个数据点，用“DBSCAN”聚类法分类
    \begin{enumerate}[label=(\alph*)]
        \item 写出算法步骤
        \item 按照算法进行3次迭代
        \item 写出最终分类结果
    \end{enumerate}
\begin{center}
\begin{tabular}{p{2cm} p{0.6cm} p{0.6cm} p{0.6cm} p{0.6cm} p{0.6cm} p{0.6cm} p{0.6cm} p{0.6cm}}
    \hline
    编号 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8\\
    \hline
    \hline
    $x$ & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8\\
    $y$ & 1 & 4 & 3 & 7 & 5 & 3 & 7 & 8\\
    \hline
\end{tabular}
\end{center} 
\end{question}
\begin{solution}
    \begin{enumerate}
        \item \emph{写出算法步骤}
        
        k-平均聚类包含以下步骤
        \begin{enumerate}[label=(\roman*)]
            \item 随机选择$k$个中心点$\{c_1,\ldots,c_k\}$
            \item 对每个数据点$x_i$，计算与所有中心点的距离$d_{ij}=|x_i-c_j|$，按最近中心点决定该点类别
            \begin{equation*}
                n_i=\argmin_{j=1}^{k} d_{ij}
            \end{equation*}
            \item 计算每个类别数据点的重心
            \begin{equation*}
                C_j=\sum_{i\in N_j} x_i/|N_j|,\,N_j=\{x_i:N_i=j\}
            \end{equation*}
            \item 对每一个类别，用重心$C_j$替换中心$c_j$
            \item 循环是否继续？是，回到(ii)；否，结束
        \end{enumerate}
        \item \emph{按照算法进行3次迭代}
        
        初始中心点为$c_1=(8,8),c_2=(5,5)$
        \begin{enumerate}
            \item 第一次迭代：
            
        距离为
        \begin{equation*}
            D = \left[\begin{array}{rrrrrrrr}
                9.90 & 7.21 & 7.07 & 4.12 & 4.24 & 5.39 & 1.41 & 0.000 \\
                5.66 & 3.16 & 2.83 & 2.24 & 0.000 & 2.24 & 2.83 & 4.24
                \end{array}\right]
        \end{equation*}
        各点的类别为
        \begin{equation*}
            N = \left[2,\,2,\,2,\,2,\,2,\,2,\,1,\,1\right]
        \end{equation*}
        重心为
        \begin{equation*}
            C_1 = (7.5,\, 7.5),C_2=(3.5,\, 3.83)
        \end{equation*}

        \item 第二次迭代：
            
        距离为
        \begin{equation*}
            \left[\begin{array}{rrrrrrrr}
                9.19 & 6.52 & 6.36 & 3.54 & 3.54 & 4.74 & 0.707 & 0.707 \\
                3.78 & 1.51 & 0.969 & 3.21 & 1.90 & 2.63 & 4.72 & 6.14
                \end{array}\right]
        \end{equation*}
        各点的类别为
        \begin{equation*}
            N = \left[2,\,2,\,2,\,2,\,2,\,2,\,1,\,1\right]
        \end{equation*}
        重心为
        \begin{equation*}
            C_1 = (7.5,\, 7.5),C_2=(3.5,\, 3.83)
        \end{equation*}

        \item 第三次迭代：
            
        距离为
        \begin{equation*}
            \left[\begin{array}{rrrrrrrr}
                9.19 & 6.52 & 6.36 & 3.54 & 3.54 & 4.74 & 0.707 & 0.707 \\
                3.78 & 1.51 & 0.969 & 3.21 & 1.90 & 2.63 & 4.72 & 6.14
                \end{array}\right]
        \end{equation*}
        各点的类别为
        \begin{equation*}
            N = \left[2,\,2,\,2,\,2,\,2,\,2,\,1,\,1\right]
        \end{equation*}
        重心为
        \begin{equation*}
            C_1 = (7.5,\, 7.5),C_2=(3.5,\, 3.83)
        \end{equation*}
        
    \end{enumerate}

    \item \emph{写出最终分类结果}
    \begin{equation*}
        N = \left[2,\,2,\,2,\,2,\,2,\,2,\,1,\,1\right]
    \end{equation*}
    \end{enumerate}
\end{solution}
\end{document}